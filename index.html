.<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>æ¼äººç¢¼é ­è¶³çƒå ´ï½œç·šä¸Šé ç´„</title>
  <meta name="description" content="Fishermanâ€™s Wharf Football Stadiumï½œäººé€ è‰åœ°ï½œå¤šåŠŸèƒ½é‹å‹•è‰åœ°ï½œç·šä¸Šé ç´„ï½œ8æŠ˜å„ªæƒ "/>
  <link rel="icon" href="assets/logo.png"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
  <style>
    :root{ --violet:#7C3AED; --green:#22C55E; }
    body{ font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; }
    .glass{ backdrop-filter: blur(14px); background: rgba(255,255,255,.72); }
    .rad { background:
      radial-gradient(1200px 600px at 5% 0%, rgba(124,58,237,.12), transparent 60%),
      radial-gradient(1000px 500px at 95% 10%, rgba(34,197,94,.12), transparent 55%); }
    .ring-accent{ box-shadow: 0 0 0 3px rgba(124,58,237,.28); }
  </style>
</head>
<body class="bg-white text-slate-900">

  <!-- é¡¶éƒ¨å„ªæƒ å¸¶ -->
  <div class="bg-gradient-to-r from-[var(--violet)] to-[var(--green)] text-white text-sm">
    <div class="max-w-7xl mx-auto px-5 py-2 flex items-center justify-between">
      <span>ğŸ¯ ç¾æ­£ <b>8 æŠ˜å„ªæƒ </b> â€” ç«‹å³é ç´„ï¼</span>
      <a href="#booking" class="underline decoration-white/70 hover:opacity-90">å‰å¾€é ç´„</a>
    </div>
  </div>

  <!-- å°è¦½ -->
  <header class="sticky top-0 z-40 border-b border-black/5 bg-white/75 glass">
    <div class="max-w-7xl mx-auto px-5 py-3 flex items-center justify-between">
      <a href="#" class="flex items-center gap-3">
  <img src="./assets/logo.png" class="h-10 w-10 object-contain" alt="FWFS"/>
        <d.iv class="leading-tight">
          <p class="font-semibold">æ¼äººç¢¼é ­è¶³çƒå ´</p>
          <p class="text-xs text-slate-600">Fishermanâ€™s Wharf Football Stadium</p>
        </div>
      </a>
      <nav class="hidden md:flex items-center gap-8 text-sm">
        <a href="#about" class="hover:text-slate-600">é—œæ–¼</a>
        <a href="#pricing" class="hover:text-slate-600">åƒ¹ç›®</a>
        <a href="#availability" class="hover:text-slate-600">æ™‚æ®µè¡¨</a>
        <a href="#booking" class="hover:text-slate-600">é ç´„</a>
        <a href="#contact" class="hover:text-slate-600">è¯çµ¡</a>
      </nav>
      <a href="#booking" class="rounded-full px-4 py-2 bg-black text-white text-sm hover:opacity-90">é ç´„å ´åœ°</a>
    </div>
  </header>

  <!-- Hero -->
  <section class="relative rad">
    <div class="max-w-7xl mx-auto px-5 py-16 md:py-24 grid md:grid-cols-12 gap-10 items-center">
      <div class="md:col-span-7">
        <h1 class="text-4xl md:text-6xl font-semibold tracking-tight leading-[1.08]">
          è¶³çƒå ´ ğŸŸï¸  äººé€ è‰åœ° ğŸŒ±  æ­¡è¿ç§Ÿå ´ ğŸ¤
        </h1>
        <p class="mt-5 text-lg text-slate-700 leading-7">
          æ¾³é–€æ¼äººç¢¼é ­è¶³çƒå ´ï¼ˆ<b>50Ã—30 m</b>ï¼‰å¤šåŠŸèƒ½é‹å‹•è‰åœ°ï¼Œé–‹æ”¾æ™‚é–“ <b>09:00â€“22:00</b>ã€‚ç·šä¸Šé ç´„å³æ™‚æª¢æŸ¥ï¼Œé¿å…é‡è¦†æ™‚æ®µã€‚
        </p>
        <div class="mt-8 flex flex-wrap gap-3">
          <a href="#booking" class="rounded-full px-6 py-3 bg-black text-white hover:opacity-90">ç«‹å³é ç´„</a>
          <a href="#pricing" class="rounded-full px-6 py-3 border border-slate-300 hover:bg-slate-50">æŸ¥çœ‹åƒ¹ç›®</a>
        </div>
        <div class="mt-6 grid grid-cols-3 gap-4 text-sm">
          <div class="rounded-xl border border-slate-200 p-4"><p class="text-slate-500">å°ºå¯¸</p><p class="font-medium">50Ã—30 m</p></div>
          <div class="rounded-xl border border-slate-200 p-4"><p class="text-slate-500">æè³ª</p><p class="font-medium">äººé€ è‰åœ°</p></div>
          <div class="rounded-xl border border-slate-200 p-4"><p class="text-slate-500">æ™‚é–“</p><p class="font-medium">09:00â€“22:00</p></div>
        </div>
      </div>
      <div class="md:col-span-5">
        <div class="rounded-3xl border border-slate-200 bg-white shadow-sm p-6">
          <img src="./assets/logo.png" class="mx-auto max-h-60 object-contain" alt="FWFS logo"/>
          <div class="mt-6 grid grid-cols-2 gap-3 text-sm">
            <div class="rounded-xl bg-violet-50 text-violet-700 border border-violet-200 p-3">å‘¨ä¸€â€“äº”ï¼šMOP 500/hr <span class="opacity-60">(8æŠ˜ 400)</span></div>
            <div class="rounded-xl bg-emerald-50 text-emerald-700 border border-emerald-200 p-3">é€±æœ«/å‡ï¼šMOP 600/hr <span class="opacity-60">(8æŠ˜ 480)</span></div>
            <div class="rounded-xl bg-slate-50 text-slate-700 border border-slate-200 p-3 col-span-2">å¤œé–“ 18â€“22ï¼šMOP 800/hr <span class="opacity-60">(8æŠ˜ 640)</span></div>
          </div>
        </div>
      </div>
    </div
  </section>

  <!-- åƒ¹ç›® -->
  <section id="pricing" class="max-w-7xl mx-auto px-5 py-16">
    <div class="flex items-center justify-between">
      <h2 class="text-2xl font-semibold">åƒ¹ç›®è¡¨</h2>
      <span class="inline-flex items-center gap-2 rounded-full px-3 py-1 text-sm bg-emerald-50 text-emerald-700 border border-emerald-200">8 æŠ˜å„ªæƒ </span>
    </div>
    <div class="mt-6 grid md:grid-cols-2 gap-6 items-start">
      <div class="rounded-2xl bg-white p-2 border border-slate-200">
        <img src="./assets/price-list.jpg" alt="åƒ¹ç›£è¡¨" class="rounded-xl w-full object-contain"/>

      </div>
      <div class="rounded-2xl bg-white p-6 border border-slate-200">
        <ul class="text-slate-700 space-y-2">
          <li>æ˜ŸæœŸä¸€è‡³äº”ï¼šMOP 500 / hrï¼ˆ8 æŠ˜ â†’ MOP 400ï¼‰</li>
          <li>é€±æœ«åŠå…¬çœ¾å‡æœŸï¼šMOP 600 / hrï¼ˆ8 æŠ˜ â†’ MOP 480ï¼‰</li>
          <li>å¤œé–“ 18:00â€“22:00ï¼šMOP 800 / hrï¼ˆ8 æŠ˜ â†’ MOP 640ï¼‰</li>
        </ul>
        <div class="mt-4 text-sm text-slate-500">* ä»¥ä¸Šåƒ¹æ ¼åƒ…ç¤ºæ„ï¼Œå¯åœ¨é é¢åº•éƒ¨ JS å€å¡Šèª¿æ•´ã€‚</div>
      </div>
    </div>
  </section>

  <!-- é ç´„ -->
  <!-- Google è©¦ç®—è¡¨ï¼šå¯ç§Ÿç”¨æ™‚æ®µ -->
  <section id="availability" class="max-w-7xl mx-auto px-5 py-16">
    <h2 class="text-2xl font-semibold">å¯ç§Ÿç”¨æ™‚æ®µï¼ˆå³æ™‚ï¼‰</h2>
    <p class="mt-2 text-slate-600">æ­¤è¡¨ç”± Google è©¦ç®—è¡¨æä¾›ï¼Œæ›´æ–°å¾Œæ•¸ç§’å…§æœƒè‡ªå‹•åæ˜ ã€‚è‹¥è¡¨æ ¼ç„¡æ³•é¡¯ç¤ºï¼Œè«‹å…ˆåœ¨ Google è©¦ç®—è¡¨ä¸­ã€Œç™¼ä½ˆåˆ°ç¶²è·¯ã€ã€‚</p>
    <div class="mt-4 rounded-2xl overflow-hidden border border-slate-200">
      <div class="relative w-full" style="height:70vh;max-height:900px;">
        <iframe
          src="https://docs.google.com/spreadsheets/d/e/2PACX-1vTWc2cifkM0LChQDPkKnzjErCP_wpIoev6w_Bc75_THcZignYe-BiK43vg9JjZxOhFpF0Nwc95XiCpz/pubhtml"
          class="absolute inset-0 w-full h-full"
          loading="lazy"
          referrerpolicy="no-referrer-when-downgrade"
        ></iframe>
      </div>
    </div>
  </section>

  <section id="booking" class="max-w-7xl mx-auto px-5 py-16">
    <h2 class="text-2xl font-semibold">ç·šä¸Šé ç´„</h2>
    <p class="mt-2 text-slate-600">é¸æ“‡æ—¥æœŸèˆ‡æ™‚æ®µï¼ˆæ•´é»ã€1â€“2 å°æ™‚ï¼‰ã€‚ç³»çµ±æœƒå³æ™‚æª¢æŸ¥ä¸¦é¿å…é‡è¦†ã€‚</p>

    <div class="mt-6 grid md:grid-cols-3 gap-6">
      <!-- æ—¥æœŸ & æ™‚æ®µ -->
      <div class="md:col-span-2 rounded-2xl bg-white border border-slate-200 p-6">
        <div class="flex items-center gap-3">
          <label class="text-sm text-slate-600">æ—¥æœŸ</label>
          <input id="date" type="date" class="rounded-xl border border-slate-300 px-3 py-2">
          <label class="ml-4 text-sm text-slate-600">æ™‚é•·</label>
          <select id="duration" class="rounded-xl border border-slate-300 px-3 py-2">
            <option value="1">1 å°æ™‚</option>
            <option value="2">2 å°æ™‚</option>
            <option value="3">3 å°æ™‚</option>
            <option value="4">4 å°æ™‚</option>
          </select>
          <div class="ml-auto text-sm text-slate-600">ç¸½åƒ¹ï¼š<span id="totalPrice" class="font-semibold">â€”</span></div>
        </div>
        <div class="mt-4 grid grid-cols-2 md:grid-cols-6 gap-2" id="slots"></div>
        <p class="mt-3 text-xs text-slate-500">ç°è‰²æ™‚æ®µç‚ºå·²è¢«é ç´„æˆ–ä¸åˆæ³•çš„çµ„åˆï¼ˆè¶…å‡º 22:00ï¼‰ã€‚</p>
      </div>

      <!-- è¡¨å–® -->
      <form id="bookingForm" class="rounded-2xl bg-white border border-slate-200 p-6 space-y-3">
        <div>
          <label class="text-sm text-slate-600">é–‹å§‹æ™‚é–“</label>
          <input id="start_time" class="w-full rounded-xl border border-slate-300 px-3 py-2" type="time" step="3600" required />
        </div>
        <div class="grid grid-cols-2 gap-3">
          <div>
            <label class="text-sm text-slate-600">è¯çµ¡äºº</label>
            <input id="name" class="w-full rounded-xl border border-slate-300 px-3 py-2" placeholder="ä½ çš„åå­—" required />
          </div>
          <div>
            <label class="text-sm text-slate-600">é›»è©±</label>
            <input id="phone" class="w-full rounded-xl border border-slate-300 px-3 py-2" placeholder="+853 ..." required />
          </div>
        </div>
        <div>
          <label class="text-sm text-slate-600">å‚™è¨»</label>
          <textarea id="notes" class="w-full h-20 rounded-xl border border-slate-300 px-3 py-2" placeholder="äººæ•¸ / æ´»å‹•é¡å‹â€¦"></textarea>
        </div>
        <button class="w-full rounded-full px-5 py-3 bg-black text-white hover:opacity-90">é€å‡ºé ç´„</button>
        <p id="status" class="text-sm text-slate-600"></p>
      </form>
    </div>
  </section>

  <!-- åœ–ç‰‡ï¼ç›¸ç°¿ä½ï¼ˆå¯æ› hero.jpgï¼‰ -->
  <section id="about" class="max-w-7xl mx-auto px-5 pb-6">
    <div class="rounded-2xl overflow-hidden border border-slate-200">
<img src="./assets/booking-environment.jpg" alt="çƒå ´ç’°å¢ƒç…§" class="rounded-xl w-full object-cover"/>
    </div>
  </section>

  <!-- è¯çµ¡ -->
  <section id="contact" class="max-w-7xl mx-auto px-5 py-16">
    <div class="rounded-2xl bg-white border border-slate-200 p-6 grid md:grid-cols-2 gap-6">
      <div>
        <h2 class="text-2xl font-semibold">è¯çµ¡æˆ‘å€‘</h2>
        <ul class="mt-4 text-slate-700 space-y-2">
          <li>ğŸ“ ç§Ÿå ´ç†±ç·šï¼š<a href="tel:+85368021668" class="underline">+853 68021668</a></li>
          <li>ğŸ•˜ é–‹æ”¾æ™‚é–“ï¼š09:00â€“22:00</li>
          <li>ğŸ“ Fishermanâ€™s Wharf Football Stadium, Macau</li>
        </ul>
      </div>
      <div class="rounded-xl border border-slate-200 p-4">
        <iframe class="w-full h-64 rounded-lg" loading="lazy" allowfullscreen src="https://maps.google.com/maps?q=22.193973,113.556095&output=embed"
></iframe>
      </div>
    </div>
  </section>

  <footer class="border-t border-slate-200">
    <div class="max-w-7xl mx-auto px-5 py-10 text-sm text-slate-500 flex flex-col md:flex-row gap-3 md:items-center md:justify-between">
      <p>Â© <span id="year"></span> Fishermanâ€™s Wharf Football Stadium</p>
      <div class="flex items-center gap-3">
        <a href="#booking" class="hover:opacity-80">ç«‹å³é ç´„</a>
        <a href="admin.html" class="hover:opacity-80">ç®¡ç†</a>
      </div>
    </div>
  </footer>

<script>
/** ====== å¯èª¿åƒæ•¸ ====== **/
const SUPABASE_URL = "https://cbebpuqfkprhamwsbhdb.supabase.co";
const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNiZWJwdXFma3ByaGFtd3NiaGRiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY5NjAxODYsImV4cCI6MjA3MjUzNjE4Nn0.GceaTOKGxBb8kCERfw9-k_KsPGnrA_8pXwBaYFar99g";
const OPEN_HOUR = 9, CLOSE_HOUR = 22; // æ•´é»
const WEEKDAY_RATE = 500, WEEKEND_RATE = 600, NIGHT_RATE = 800; // æ¯å°æ™‚
const DISCOUNT = 0.8; // 8æŠ˜
const NIGHT_FROM = 18; // å¤œé–“èµ·

/** ====== åˆå§‹åŒ– ====== **/
const sb = supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
document.getElementById('year').textContent = new Date().getFullYear();
const dateEl = document.getElementById('date');
const durationEl = document.getElementById('duration');
const totalPriceEl = document.getElementById('totalPrice');
const slotsEl = document.getElementById('slots');
const startInput = document.getElementById('start_time');
const form = document.getElementById('bookingForm');
const statusEl = document.getElementById('status');

// é è¨­æ—¥æœŸï¼šä»Šå¤©
dateEl.value = new Date().toISOString().slice(0,10);
renderSlots();
calcPrice();
dateEl.addEventListener('change', ()=>{ renderSlots(); calcPrice(); });
durationEl.addEventListener('change', ()=>{ renderSlots(); calcPrice(); });

/** ====== åƒ¹æ ¼è¨ˆç®— ====== **/
function isWeekend(isoDate){
  const d = new Date(isoDate); const day = d.getDay(); // 0 Sun, 6 Sat
  return day===0 || day===6;
}
function calcPrice() {
  const dur       = parseInt(durationEl.value);                  // æ™‚é•·
  const startHour = parseInt(startInput.value.split(':')[0]);    // å–é–‹å§‹çš„ã€Œæ™‚ã€(00â€“23)

  // åˆ¤æ–·ä½¿ç”¨å“ªå€‹è²»ç‡ï¼šå¤œé–“ > é€±æœ« > å¹³æ—¥
  let baseRate;
  if (startHour >= NIGHT_FROM) {
    baseRate = NIGHT_RATE;
  } else {
    baseRate = isWeekend(dateEl.value) ? WEEKEND_RATE : WEEKDAY_RATE;
  }

  // è¨ˆç®—ç¸½åƒ¹
  let total = baseRate * dur;

  // å¹³æ—¥ç™½å¤©çµ¦ 8 æŠ˜å„ªæƒ 
  if (startHour < NIGHT_FROM && !isWeekend(dateEl.value)) {
    total = total * DISCOUNT;
  }

  totalPriceEl.textContent = `MOP ${total}`;
}

/** ====== æ™‚æ®µæ¸²æŸ“ï¼ˆé¿å…é‡ç–Šï¼‰ ====== **/
function pad(n){ return String(n).padStart(2,'0'); }
function toMin(t){ const [h,m] = t.split(':').map(Number); return h*60+m; }
function overlap(aS,aE,bS,bE){ return aS < bE && bS < aE; } // [start, end)

async function getBookingsByDate(isoDate){
  const { data, error } = await sb.from('bookings')
    .select('start_time,end_time')
    .eq('date', isoDate);
  if (error) { console.error(error); return []; }
  return data||[];
}

async function renderSlots(){
  // æ¸…ç©ºåŸæœ‰æŒ‰éˆ•
  slotsEl.innerHTML = '';
  const iso = dateEl.value;
  const duration = parseInt(durationEl.value);
  // å–å¾—ç•¶å¤©å·²æœ‰é ç´„çš„æ™‚æ®µ
  const existing = await getBookingsByDate(iso);
  const occupied = existing.map(b => [toMin(b.start_time), toMin(b.end_time)]);

  // ä¾ç…§é¸æ“‡çš„æ™‚é•·ç”¢ç”Ÿæ‰€æœ‰åˆæ³•æ™‚æ®µ
  for (let h = OPEN_HOUR; h + duration <= CLOSE_HOUR; h++) {
    const start = `${pad(h)}:00`;
    const endHour = h + duration;
    const end = `${pad(endHour)}:00`;
    const startM = h * 60;
    const endM = endHour * 60;
    // åˆ¤æ–·æ˜¯å¦è¶…å‡ºç‡Ÿæ¥­æ™‚é–“æˆ–èˆ‡å·²æœ‰é ç´„è¡çª
    const illegal = endHour > CLOSE_HOUR;
    const blocked = occupied.some(([s,e]) => overlap(startM, endM, s, e));

    const btn = document.createElement('button');
    btn.type = 'button';
    btn.textContent = `${start}â€“${end}`;
    btn.className = "px-3 py-2 rounded-full border text-sm " +
      (illegal || blocked ? "bg-slate-100 text-slate-400 cursor-not-allowed"
                          : "hover:bg-black hover:text-white");
    btn.disabled = illegal || blocked;

    if (!btn.disabled) {
      btn.onclick = () => {
        startInput.value = start;
        // é«˜äº®ç•¶å‰é¸æ“‡ä¸¦è¨ˆç®—åƒ¹æ ¼
        Array.from(slotsEl.children).forEach(x => x.classList.remove('ring-accent'));
        btn.classList.add('ring-accent');
        calcPrice();
      };
    }
    slotsEl.appendChild(btn);
  }
}

// Realtimeï¼šç•¶å¤©æœ‰äººæ–°é ç´„ â†’ é‡æ–°æ¸²æŸ“
sb.channel('bookings-realtime')
  .on('postgres_changes',{event:'*',schema:'public',table:'bookings'},(payload)=>{
    if (dateEl.value) renderSlots();
  })
  .subscribe();

/** ====== é€å‡ºé ç´„ï¼ˆå†æ¬¡æª¢æŸ¥é‡ç–Šï¼‰ ====== **/
form.addEventListener('submit', async (e)=>{
  e.preventDefault();
  statusEl.textContent = "æª¢æŸ¥æ™‚æ®µä¸­â€¦";
  const dur = +durationEl.value;
  const start = startInput.value;
  const endHour = parseInt(start.slice(0,2),10) + dur;
  const end = `${pad(endHour)}:00`;
  const payload = {
    date: dateEl.value,
    start_time: start + ':00'.slice(start.length-2), // ä¿è­‰ HH:MM:SS
    end_time: end + ':00'.slice(end.length-2),
    name: document.getElementById('name').value.trim(),
    phone: document.getElementById('phone').value.trim(),
    notes: document.getElementById('notes').value.trim()
  };
  // æœ€çµ‚é‡ç–Šæª¢æŸ¥
  const existing = await getBookingsByDate(payload.date);
  const reqS = toMin(payload.start_time), reqE = toMin(payload.end_time);
  const conflict = existing.some(b => overlap(reqS, reqE, toMin(b.start_time), toMin(b.end_time)));
  if (conflict){ statusEl.textContent = "æ­¤æ™‚æ®µå·²è¢«é ç´„ï¼Œè«‹æ›ä¸€å€‹æ™‚æ®µã€‚"; await renderSlots(); return; }

  // Insert
  try{
    const { error } = await sb.from('bookings').insert(payload);
    if (error) throw error;
    statusEl.textContent = "âœ… é ç´„æˆåŠŸï¼æˆ‘å€‘æœƒç›¡å¿«èˆ‡ä½ è¯çµ¡ã€‚";
    statusEl.className = "text-sm text-green-600";
    form.reset();
    renderSlots();
  }catch(err){
    statusEl.textContent = "âŒ é ç´„å¤±æ•—ï¼š" + (err.message||err);
    statusEl.className = "text-sm text-red-600";
  }
});
</script>
</body>
</html>

